// Deck Mortar (General Munitions) Automation Component
// Allows the deck mortar to work with AI cores and reduces crew requirement per AI buff

PartCrew
{
	Type = MultiToggle
	Toggles = [PartCrewMinusNone, PartCrewMinusOne, PartCrewMinusTwo, PartCrewMinusThree, PartCrewMinusFour]
	Mode = Any
}

NeedsCrewMinusNone
{
	Type = MultiToggle
	Toggles = [NeedsCrewMinusOne, NeedsCrewMinusTwo, NeedsCrewMinusThree, NeedsCrewMinusFour]
	Mode = Any
	Invert = True
}

NeedsCrewMinusOne
{
	Type = BuffToggle
	BuffType = Aredja2AITerminal
	MinBuffValue = 1
	MaxBuffValue = 1
}

NeedsCrewMinusTwo
{
	Type = BuffToggle
	BuffType = Aredja2AITerminal
	MinBuffValue = 2
	MaxBuffValue = 2
}

NeedsCrewMinusThree
{
	Type = BuffToggle
	BuffType = Aredja2AITerminal
	MinBuffValue = 3
	MaxBuffValue = 3
}

NeedsCrewMinusFour
{
	Type = BuffToggle
	BuffType = Aredja2AITerminal
	MinBuffValue = 4
}

// Standard crew requirement (4 crew)
PartCrewMinusNone
{
	Type = PartCrew
	Crew = 4
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusNone]
	HighPriorityPrerequisites = [AmmoPrereq]
	CrewDestinations
	[
		&../../CrewLocation1/Location
		&../../CrewLocation2/Location
		&../../CrewLocation3/Location
		&../../CrewLocation4/Location
	]
	CrewLocations
	[
		CrewLocation1
		CrewLocation2
		CrewLocation3
		CrewLocation4
	]
}

// Reduced to 3 crew when one AI buff present
PartCrewMinusOne
{
	Type = PartCrew
	Crew = 3
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusOne]
	OverridePriorityKey = PartCrewMinusNone
	CrewDestinations
	[
		&../../CrewLocation1/Location
		&../../CrewLocation2/Location
		&../../CrewLocation3/Location
	]
	CrewLocations
	[
		CrewLocation1
		CrewLocation2
		CrewLocation3
	]
}

// Reduced to 2 crew when two AI buffs present
PartCrewMinusTwo
{
	Type = PartCrew
	Crew = 2
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusTwo]
	OverridePriorityKey = PartCrewMinusNone
	CrewDestinations
	[
		&../../CrewLocation1/Location
		&../../CrewLocation2/Location
	]
	CrewLocations
	[
		CrewLocation1
		CrewLocation2
	]
}

// Reduced to 1 crew when three AI buffs present
PartCrewMinusThree
{
	Type = PartCrew
	Crew = 1
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusThree]
	OverridePriorityKey = PartCrewMinusNone
	CrewDestinations
	[
		&../../CrewLocation1/Location
	]
	CrewLocations
	[
		CrewLocation1
	]
}

// No crew needed when four or more AI buffs present
PartCrewMinusFour
{
	Type = BuffToggle
	BuffType = Aredja2AITerminal
	MinBuffValue = 4
}

// Crew locations from original part definition
CrewLocation1 { Type = CrewLocation; Location = [89/64, 110/64] }
CrewLocation2 { Type = CrewLocation; Location = [166/64, 110/64] }
CrewLocation3 { Type = CrewLocation; Location = [67/64, 189/64] }
CrewLocation4 { Type = CrewLocation; Location = [189/64, 189/64] } 