// Heavy Deck Battery (Laser Emporium) Automation Component
// Allows the heavy deck battery to work with AI cores.
// This version uses the standard BuffToggle system.

// Main PartCrew component - determines which crew mode to use based on AI buffs.
PartCrew
{
	Type = MultiToggle
	Toggles = [PartCrewMinusNone, PartCrewMinusOne, PartCrewMinusTwo, PartCrewMinusThree, PartCrewMinusFour, PartCrewMinusFive]
	Mode = Any
}

// This toggle activates when no AI core buff is detected.
NeedsCrewMinusNone
{
	Type = MultiToggle
	Toggles = [NeedsCrewMinusOne, NeedsCrewMinusTwo, NeedsCrewMinusThree, NeedsCrewMinusFour, PartCrewMinusFive]
	Mode = Any
	Invert = True
}

// These toggles activate based on the strength of the Aredja2AITerminal buff.
NeedsCrewMinusOne		{ Type = BuffToggle; BuffType = Aredja2AITerminal; MinBuffValue = 1; MaxBuffValue = 1 }
NeedsCrewMinusTwo		{ Type = BuffToggle; BuffType = Aredja2AITerminal; MinBuffValue = 2; MaxBuffValue = 2 }
NeedsCrewMinusThree	    { Type = BuffToggle; BuffType = Aredja2AITerminal; MinBuffValue = 3; MaxBuffValue = 3 }
NeedsCrewMinusFour		{ Type = BuffToggle; BuffType = Aredja2AITerminal; MinBuffValue = 4; MaxBuffValue = 4 }
PartCrewMinusFive		{ Type = BuffToggle; BuffType = Aredja2AITerminal; MinBuffValue = 5 }

// Standard crew component - requires 5 crew when no AI is detected.
PartCrewMinusNone
{
	Type = PartCrew
	Crew = 5
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusNone]
	HighPriorityPrerequisites = [BatteryStorage]
	CrewDestinations
	[
		[1.265625, 1.828125]
		[2.734375, 1.828125]
		[.52, .48]
		[3.48, .48]
		[2, 3]
	]
	CrewLocations
	[
		CrewLocation1
		CrewLocation2
		CrewLocation3
		CrewLocation4
		CrewLocation5
	]
}

// Requires 4 crew when AI buff = 1.
PartCrewMinusOne
{
	Type = PartCrew
	Crew = 4
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusOne]
	HighPriorityPrerequisites = [BatteryStorage]
	OverridePriorityKey = PartCrewMinusNone
	CrewDestinations
	[
		[1.265625, 1.828125]
		[2.734375, 1.828125]
		[.52, .48]
		[3.48, .48]
	]
	CrewLocations
	[
		CrewLocation1
		CrewLocation2
		CrewLocation3
		CrewLocation4
	]
}

// Requires 3 crew when AI buff = 2.
PartCrewMinusTwo
{
	Type = PartCrew
	Crew = 3
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusTwo]
	HighPriorityPrerequisites = [BatteryStorage]
	OverridePriorityKey = PartCrewMinusNone
	CrewDestinations
	[
		[1.265625, 1.828125]
		[2.734375, 1.828125]
		[.52, .48]
	]
	CrewLocations
	[
		CrewLocation1
		CrewLocation2
		CrewLocation3
	]
}

// Requires 2 crew when AI buff = 3.
PartCrewMinusThree
{
	Type = PartCrew
	Crew = 2
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusThree]
	HighPriorityPrerequisites = [BatteryStorage]
	OverridePriorityKey = PartCrewMinusNone
	CrewDestinations
	[
		[1.265625, 1.828125]
		[2.734375, 1.828125]
	]
	CrewLocations
	[
		CrewLocation1
		CrewLocation2
	]
}

// Requires 1 crew when AI buff = 4.
PartCrewMinusFour
{
	Type = PartCrew
	Crew = 1
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusFour]
	HighPriorityPrerequisites = [BatteryStorage]
	OverridePriorityKey = PartCrewMinusNone
	CrewDestinations
	[
		[1.265625, 1.828125]
	]
	CrewLocations
	[
		CrewLocation1
	]
}

// Crew locations from the original part
CrewLocation1 
{
	Type = CrewLocation
	Location = [-0.63, -1.325]
	ChainedTo = Turret
	Rotation = 90d
}
CrewLocation2 
{
	Type = CrewLocation
	Location = [-0.63, 1.325]
	ChainedTo = Turret
	Rotation = 90d
}
CrewLocation3 
{
	Type = CrewLocation
	Location = [1, 1.135]
	ChainedTo = Turret
	Rotation = -45d
}
CrewLocation4 
{
	Type = CrewLocation
	Location = [1, -1.135]
	ChainedTo = Turret
	Rotation = 45d
}
CrewLocation5 
{
	Type = CrewLocation
	Location = [1.2, 0]
	ChainedTo = Turret
	Rotation = 90d
}
