// Large Turret (Galactic Allegiance) Automation Component
// Allows the large turret to work with AI cores

PartCrew
{
	Type = MultiToggle
	Toggles = [PartCrewMinusNone, PartCrewMinusOne, PartCrewMinusTwo] // PartCrewMinusTwo is the 0-crew AI state
	Mode = Any
}

// This toggle is TRUE if AI buff is 0
NeedsCrewMinusNone
{
	Type = MultiToggle
	Toggles = [Buff_Is_1, Buff_Is_2_Or_More] // References the specific buff level toggles
	Mode = Any
	Invert = True
}

// --- Buff Level Toggles ---
Buff_Is_1
{
	Type = BuffToggle
	BuffType = Aredja2AITerminal
	MinBuffValue = 1
	MaxBuffValue = 1 // Active if buff is exactly 1
}
// This IS PartCrewMinusTwo
Buff_Is_2_Or_More
{
	Type = BuffToggle
	BuffType = Aredja2AITerminal
	MinBuffValue = 2 // Active if buff is 2 or more
}

// --- PartCrew Components for each AI Buff Level ---

// Standard crew component - requires 2 crew when AI buff is 0
PartCrewMinusNone
{
	Type = PartCrew
	Crew = 2
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, NeedsCrewMinusNone] // Gated by AI buff being 0
	HighPriorityPrerequisites = [BatteryStorage]
	CrewDestinations
	[
		[1, 1.453125],
		[2, 1.453125]
	]
	CrewLocations
	[
		CrewLocation1,
		CrewLocation2
	]
}

// Requires 1 crew when AI buff of 1 is present
PartCrewMinusOne
{
	Type = PartCrew
	Crew = 1
	DefaultPriority = &/PRIORITIES/Weapon_Crew
	PrerequisitesBeforeCrewing = [PowerToggle, Buff_Is_1] // Gated by AI buff being 1
	OverridePriorityKey = PartCrewMinusNone
	HighPriorityPrerequisites = [BatteryStorage]
	CrewDestinations
	[
		[1, 1.453125]
	]
	CrewLocations
	[
		CrewLocation1
	]
}

// No crew needed when AI buff of 2 or higher. This component IS the Buff_Is_2_Or_More toggle.
PartCrewMinusTwo : &Buff_Is_2_Or_More {}

// Crew locations
CrewLocation1 { Type = CrewLocation; Location = [1, 1.453125] }
CrewLocation2 { Type = CrewLocation; Location = [2, 1.453125] } 